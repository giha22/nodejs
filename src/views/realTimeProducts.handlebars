<h1>Productos en tiempo real</h1>

<form id="productForm">
    <input type="text" name="title" placeholder="Título" required />
    <input type="text" name="description" placeholder="Descripción" required />
    <input type="number" name="price" placeholder="Precio" required />
    <input type="text" name="code" placeholder="Código" required />
    <input type="number" name="stock" placeholder="Stock" required />
    <input type="text" name="category" placeholder="Categoría" />
    <button type="submit">Agregar</button>
</form>

<ul id="productList"></ul>

<script src="/socket.io/socket.io.js"></script>
<script>
    const socket = io();

    const form = document.getElementById("productForm");
    const list = document.getElementById("productList");

    socket.on("products", (data) => {
        list.innerHTML = "";
        data.forEach(p => {
            list.innerHTML += `<li>${p.title} - $${p.price}</li>`;
        });
    });

    form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const formData = Object.fromEntries(new FormData(form));
        await fetch("/api/products", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(formData)
        });
        form.reset();
    });
</script>